<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>Adobe Photoshop Paragraph Generator</title>
  <style>
    body {
      font-family: Verdana, sans-serif;
      background-color: #f4f8ff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      height: 100vh;
      justify-content: flex-start;
    }

    h1 {
      text-align: center;
      color: #004080;
      margin-bottom: 20px;
      font-size: 20px;
    }

    textarea {
      width: 20cm;
      height: 60px;
      font-size: 16px;
      padding: 20px;
      border: 3px solid #4da6ff;
      border-radius: 8px;
      resize: none;
    }

    #output {
      white-space: pre-line;
      margin-top: 20px;
      padding: 20px;
      width: 20cm;
      height: calc(50vh - 60px);
      border: 3px solid #4da6ff;
      border-radius: 8px;
      background: white;
      text-align: left;
      font-size: 23.81pt;
      font-family: Verdana, sans-serif;
      overflow-y: auto;
    }

    #validationMessage {
      margin-top: 20px;
      text-align: center;
      font-size: 20px;
      color: #cc0000;
    }

    .special-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 10px;
    }

    .special-buttons button {
      font-family: Verdana, sans-serif;
      font-size: 20px;
      padding: 6px 16px;
      border: 2px solid #cc0000;
      border-radius: 8px;
      background-color: #fff0f0;
      color: #cc0000;
      cursor: pointer;
    }

    .special-buttons button:hover {
      background-color: #ffe6e6;
    }

    #copiedNotice {
      margin-top: 10px;
      font-size: 16px;
      color: green;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    #copiedNotice.show {
      opacity: 1;
    }

  </style>
</head>
<body>
  <h1>Adobe Photoshop Paragraph Generator</h1>
  <textarea id="input" placeholder="Text here..."></textarea>
  <div id="output"></div>
  <div id="copiedNotice">✅ Copiat în clipboard</div>
  <div id="validationMessage"></div>


  <script>
    const input = document.getElementById('input');
    const output = document.getElementById('output');
    const validationMessage = document.getElementById('validationMessage');
    const copiedNotice = document.getElementById('copiedNotice');

    let currentData = {
      id: '', data: '', ora: '', client: '', agent: '',
      produs: '', cant: '', necesitaDetalii: false, detalii: ''
    };

    function formatTextFromData() {
      return `Comanda: ${currentData.id} ${currentData.data} ${currentData.ora}
              Client: ${currentData.client}
              Agent: ${currentData.agent}

              Produs: ${currentData.cant}x ${currentData.produs}
              Detalii: ${currentData.detalii}`;
    }

    function parseInput(raw) {
        const parts = raw.trim().split(/\s{2,}/);

        if (parts.length < 7) return { valid: false };

        const knownAgents = ["Luminita", "Madalina", "Mihai C.", "Updeco"];
        let [id, data, ora, client, grafica, agent, produs, cantRaw, ...emailsIgnored] = parts;

        if (knownAgents.includes(grafica)) { 

              cantRaw = produs;
              produs = agent;
              agent = grafica;
              grafica = "fara grafica";
        } 

        //conditii de verificare

        if (!["Updeco", "Madalina", "Mihai C.", "Luminita"].includes(agent)) {
            alert("Nume agent incorect!");
            return { valid: false };
        }
        //if (id<10000) return (alert("Id incorect!"), { valid: false });
        if (agent == "Updeco") { agent= " "; } 

      const cant = cantRaw ? cantRaw.replace(/[^0-9]/g, '') : '1';

      const produsLower = produs.toLowerCase();
      const necesitaDetalii = produsLower.includes("wave") || produsLower.includes("portalight") || produsLower.includes("lightbox");

      return {
        valid: true,
        id, data, ora, client, agent,
        produs, cant,
        necesitaDetalii,
        detalii: necesitaDetalii ? "1 Față" : ""
      };
    
  }

 
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        copiedNotice.classList.add("show");
        setTimeout(() => copiedNotice.classList.remove("show"), 2000);
      });
    }

    function renderOutputAndClipboard() {
      const finalText = formatTextFromData();
      output.textContent = finalText;
      copyToClipboard(finalText);
    }

    function showButtons() {
      validationMessage.innerHTML = `
        Alte detalii/observații?<br>
        <div class="special-buttons">
          <button onclick="selectDetalii('1 Față')">1 Față</button>
          <button onclick="selectDetalii('2 Fețe')">2 Fețe</button>
        </div>
      `;
    }

    window.selectDetalii = function(text) {
      currentData.detalii = text;
      renderOutputAndClipboard();
    }

    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();

        const parsed = parseInput(input.value);
        if (!parsed.valid) {
          output.textContent = "⚠️ Format invalid.";
          validationMessage.textContent = "";
          return;
        }
        input.value = '';
        currentData = parsed;
        renderOutputAndClipboard();

        if (parsed.necesitaDetalii) {
          showButtons();
        } else {
          validationMessage.innerHTML = "";
        }

      } 
    });

    // test cu nume grafica: 12345   20.04.2025    14:00    Emag     Dive in JIJU   Luminita   Roll up vision 085     10 buc     eu@yahoo.com
    // test fara nume grafica: 12345   20.04.2025    14:00    ProVisionSrl      Mihai C.   Roll up vision 085     20 buc     eu@yahoo.com
    // test cu nume grafica: 12345   20.04.2025    14:00    Emag     Dive in JIJU   Luminita   Wave vision 085     10 buc     eu@yahoo.com
    // test fara nume grafica: 12345   20.04.2025    14:00    ProVisionSrl    alb cu rosu minecraft    Updeco   UPDECO Beambag Para XL     20 buc     eu@yahoo.com    eu@yahoo.com
    // test fara nume grafica: 12345   20.04.2025    14:00    ProVisionSrl      Mihai C.   Lightbox vision 085     20 buc     eu@yahoo.com
  </script>
</body>
</html>
